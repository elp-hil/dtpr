%% simulationSoftware.tex
%%

%% ==============
\chapter{Simulation software}
\label{ch:Simulation software}
%% ==============
  To compare the data aquired to theoretically expected values, a Geant4 simulation of cosmic showers has been set up including the geometry of the main spectrometer as well as the muon modules.
  %% ===========================
  \section{Geant4}
  \label{ch:Simulation software:sec:Geant4}
  %% ===========================
  The Geant4 package is a powerful tool for simulation of particles. It has loads of possible interactions already integrated making it easy for the user to set up and run simulations. After setting up geometry and detectors, the user starts a run. Each run may consist of one or more events. During a single run, a loop of processes is called, i.e.:
  \begin{itemize}	
  	\item Primary Generator Action
  	\item Run action
  	\item Event action
  	\item Stacking action
  	\item Tracking action
  	\item Stepping action
  \end{itemize}
  For the user, for each action, there are classes called user action called before ar after the standard action class. Through those, it is possible to change behaviour of the simulation or extract data needed.
  
  Running the simulation, one can either interactively enter commands or write those to a .mac file, by default the vis.mac file, which are then sequentially executed. 


  %% ===========================
  \section{Geometry setup}
  \label{ch:Simulation software:sec:Geometry setup}
  %% ===========================
  The main spectrometer geometry was already \todo{written by who?} existant but had to be modified as many of the border volumes implemented here were not needed for this simulation. Additionally, the muon modules have been added as sensitive volume. 
  
  %% ===========================
  \section{Muon generator}
  \label{ch:Simulation software:sec:Muon generator}
  %% ===========================  
  
  Muon generation was realised through the primary generator action. The angular distribution suggested by Henrik Arlinghaus \todo{cite} was implemented. The angular rate dependance is shown in \todo{ref figure}.The energy was set to \todo{reasonable value} disregarding the actual anergy distribution as this was mainly about flight paths that are not strongly dependant on energy at high energies. Starting positions were spherically distributed, with the direction towards the origin, which is in the center of the main spectrometer. Positions were then randomly moved in a volume surrounding the spectrometer to account for the non-point like structure of the detection systam as a whole.
  
  %% ===========================
  \section{Hit counter}
  \label{ch:Simulation software:sec:Hit counter}
  %% ===========================
  
  For comparing the simulation to real data, of all the events generated, those hitting modules were counted. Each event containing at least one hit is written into a file for further analysis. This made it possible for the 
  